import acyclicity
import networkx as nx
import random

def test1_acyclicity():
    graph=[[0, 1], [3, 0], 
           [1, 2], [2, 0]]
    returnvalue=acyclicity.acyclic(graph)
    assert returnvalue==1


def test2_acyclicity():
    graph=[[58, 1],
        [76, 43],
        [72, 91],
        [47, 80],
        [38, 44],
        [76, 70],
        [85, 18],
        [60, 83],
        [80, 40],
        [6, 11],
        [69, 58],
        [87, 18],
        [47, 82],
        [32, 78],
        [66, 89],
        [89, 54],
        [16, 79],
        [78, 63],
        [30, 41],
        [42, 98],
        [71, 24],
        [93, 54],
        [20, 15],
        [91, 20],
        [54, 44],
        [14, 35],
        [16, 8],
        [95, 8],
        [72, 6],
        [49, 75],
        [24, 76],
        [78, 1],
        [42, 100],
        [2, 91],
        [45, 71],
        [22, 69],
        [71, 35],
        [28, 9],
        [26, 57],
        [41, 30],
        [88, 35],
        [40, 22],
        [4, 11],
        [98, 20],
        [73, 64],
        [91, 45],
        [42, 95],
        [47, 63],
        [100, 75],
        [34, 41],
        [96, 34],
        [18, 75],
        [39, 73],
        [89, 10],
        [12, 74],
        [80, 89],
        [33, 78],
        [87, 58],
        [38, 86],
        [20, 80],
        [77, 13],
        [81, 38],
        [42, 10],
        [81, 1],
        [73, 52],
        [56, 36],
        [93, 30],
        [98, 81],
        [53, 58],
        [46, 74],
        [23, 51],
        [2, 37],
        [57, 46],
        [80, 11],
        [27, 96],
        [71, 84],
        [64, 26],
        [93, 7],
        [28, 42],
        [89, 55],
        [33, 96],
        [92, 63],
        [53, 83],
        [50, 66],
        [61, 11],
        [21, 94],
        [56, 79],
        [33, 68],
        [36, 39],
        [30, 32],
        [21, 69],
        [26, 83],
        [36, 5],
        [18, 88],
        [71, 36],
        [8, 16],
        [17, 92],
        [14, 38],
        [13, 70],
        [4, 46]]

    returnvalue=acyclicity.acyclic(graph)

    assert returnvalue==1

def test3_acyclicity():
    graph=[[0, 1], 
           [1, 2], [2, 3]]
    test_acyclicity(graph)

def test4_acyclicity():
    graph=[[0, 1], [1, 2], [2, 3],
           [4, 5], [5, 6], [6, 7],[7,4]]
    returnvalue=acyclicity.acyclic(graph)
    assert returnvalue==1

def test5_acyclicity():
    graph=[[0, 1], [1, 2], [2, 3],[3,1]]
    returnvalue=acyclicity.acyclic(graph)
    assert returnvalue==1

def test6_acyclicity():
    graph=[[0, 1], [1, 2], [2, 3],
           [4, 5], [5, 6], [6, 7],[7,0]]
    returnvalue=acyclicity.acyclic(graph)
    assert returnvalue==0

def test7_acyclicity():
    graph=[[118, 40],
            [89, 123],
            [25, 96],
            [19, 110],
            [88, 45],
            [42, 57],
            [88, 109],
            [177, 37],
            [73, 19],
            [2, 96],
            [171, 118],
            [117, 37],
            [99, 129],
            [3, 88],
            [200, 7],
            [107, 17],
            [195, 93],
            [188, 54],
            [39, 92],
            [194, 94],
            [130, 3],
            [162, 135],
            [126, 32],
            [98, 199],
            [53, 112],
            [72, 143],
            [110, 127],
            [110, 200],
            [38, 96],
            [60, 62],
            [93, 74],
            [120, 156],
            [167, 118],
            [140, 88],
            [78, 58],
            [62, 135],
            [31, 19],
            [151, 54],
            [195, 54],
            [77, 144],
            [151, 127],
            [60, 155],
            [53, 61],
            [101, 80],
            [11, 43],
            [146, 51],
            [130, 119],
            [53, 173],
            [33, 85],
            [31, 124],
            [102, 175],
            [129, 49],
            [66, 164],
            [183, 166],
            [70, 143],
            [133, 156],
            [142, 104],
            [162, 146],
            [154, 23],
            [37, 103],
            [100, 107],
            [158, 121],
            [166, 134],
            [44, 181],
            [96, 11],
            [53, 40],
            [64, 104],
            [188, 158],
            [103, 16],
            [48, 80],
            [195, 35],
            [151, 163],
            [156, 159],
            [72, 19],
            [114, 34],
            [78, 14],
            [138, 65],
            [152, 173],
            [145, 134],
            [154, 27],
            [112, 30],
            [50, 119],
            [69, 86],
            [115, 172],
            [145, 127],
            [128, 175],
            [178, 14],
            [112, 197],
            [36, 174],
            [187, 90],
            [169, 139],
            [132, 99],
            [7, 31],
            [2, 108],
            [145, 1],
            [20, 107],
            [150, 82],
            [98, 163],
            [92, 22],
            [37, 31],
        ]
    for x in range(0,len(graph)):
        graph[x][0]=graph[x][0]-1
        graph[x][1]=graph[x][1]-1

    returnvalue=acyclicity.acyclic(graph)
    assert returnvalue==1

def test8_acyclicity():
    graph=[[745, 275],
            [697, 464],
            [437, 397],
            [135, 602],
            [96, 769],
            [901, 797],
            [487, 105],
            [862, 140],
            [558, 412],
            [953, 169],
            [802, 611],
            [300, 364],
            [644, 991],
            [749, 92],
            [894, 367],
            [410, 406],
            [584, 568],
            [549, 839],
            [318, 845],
            [983, 942],
            [94, 524],
            [889, 270],
            [957, 386],
            [356, 17],
            [833, 854],
            [704, 880],
            [566, 272],
            [400, 496],
            [526, 56],
            [1, 234],
            [253, 953],
            [314, 554],
            [605, 358],
            [145, 782],
            [381, 226],
            [916, 897],
            [392, 223],
            [118, 499],
            [216, 415],
            [794, 401],
            [2, 980],
            [460, 385],
            [946, 916],
            [952, 420],
            [987, 130],
            [536, 105],
            [342, 249],
            [417, 23],
            [945, 142],
            [488, 739],
            [326, 250],
            [447, 567],
            [495, 189],
            [15, 784],
            [21, 953],
            [821, 866],
            [956, 17],
            [671, 442],
            [908, 278],
            [819, 942],
            [324, 743],
            [545, 46],
            [433, 897],
            [7, 151],
            [111, 190],
            [405, 179],
            [25, 294],
            [467, 410],
            [867, 371],
            [360, 912],
            [48, 417],
            [266, 905],
            [744, 529],
            [7, 654],
            [945, 946],
            [915, 277],
            [159, 788],
            [981, 887],
            [205, 764],
            [664, 951],
            [264, 306],
            [790, 910],
            [6, 685],
            [56, 137],
            [48, 700],
            [296, 146],
            [10, 179],
            [434, 763],
            [772, 75],
            [83, 676],
            [264, 989],
            [524, 629],
            [258, 766],
            [447, 791],
            [757, 184],
            [432, 802],
            [132, 123],
            [783, 987],
            [915, 151],
            [267, 842],
            [463, 381],
            [214, 988],
            [40, 296],
            [444, 547],
            [86, 183],
            [913, 199],
            [528, 626],
            [792, 565],
            [571, 844],
            [350, 238],
            [891, 705],
            [652, 936],
            [15, 635],
            [924, 464],
            [84, 515],
            [168, 81],
            [812, 897],
            [176, 836],
            [313, 594],
            [460, 375],
            [133, 874],
            [610, 152],
            [241, 169],
            [233, 76],
            [736, 538],
            [701, 666],
            [943, 190],
            [828, 868],
            [386, 434],
            [171, 357],
            [715, 344],
            [104, 456],
            [655, 479],
            [694, 788],
            [229, 60],
            [646, 986],
            [551, 587],
            [209, 222],
            [224, 866],
            [141, 770],
            [773, 309],
            [452, 891],
            [710, 369],
            [708, 826],
            [525, 76],
            [297, 218],
            [660, 130],
            [284, 764],
            [897, 451],
            [663, 531],
            [837, 329],
            [758, 274],
            [285, 490],
            [515, 705],
            [587, 810],
            [625, 675],
            [588, 537],
            [946, 254],
            [576, 819],
            [61, 453],
            [248, 459],
            [764, 223],
            [468, 301],
            [160, 346],
            [72, 382],
            [935, 608],
            [673, 95],
            [257, 266],
            [937, 123],
            [952, 926],
            [990, 135],
            [897, 334],
            [480, 540],
            [640, 165],
            [662, 351],
            [346, 887],
            [59, 803],
            [196, 790],
            [856, 73],
            [822, 825],
            [316, 855],
            [505, 880],
            [223, 398],
            [555, 719],
            [440, 741],
            [380, 220],
            [345, 360],
            [193, 384],
            [704, 698],
            [299, 640],
            [507, 440],
            [280, 636],
            [194, 456],
            [105, 793],
            [33, 786],
            [947, 294],
            [910, 174],
            [271, 843],
            [970, 853],
            [717, 106],
            [894, 971],
            [122, 863],
            [280, 254],
            [364, 238],
            [613, 534],
            [89, 119],
            [383, 346],
            [209, 230],
            [348, 388],
            [589, 451],
            [575, 943],
            [608, 464],
            [402, 368],
            [646, 338],
            [620, 438],
            [96, 191],
            [86, 635],
            [295, 260],
            [265, 875],
            [685, 415],
            [856, 315],
            [855, 350],
            [153, 405],
            [571, 829],
            [481, 499],
            [531, 128],
            [802, 442],
            [117, 659],
            [937, 639],
            [115, 311],
            [238, 140],
            [562, 609],
            [781, 922],
            [267, 292],
            [747, 502],
            [612, 457],
            [901, 331],
            [598, 284],
            [373, 602],
            [226, 925],
            [491, 832],
            [673, 67],
            [358, 577],
            [665, 72],
            [232, 599],
            [265, 358],
            [630, 648],
            [112, 36],
            [572, 277],
            [837, 184],
            [95, 868],
            [377, 190],
            [186, 232],
            [337, 630],
            [400, 668],
            [361, 331],
            [8, 967],
            [844, 574],
            [480, 130],
            [25, 242],
            [805, 97],
            [198, 551],
            [667, 621],
            [25, 251],
            [340, 653],
            [600, 869],
            [574, 969],
            [108, 505],
            [419, 290],
            [949, 846],
            [705, 495],
            [732, 521],
            [242, 505],
            [113, 202],
            [684, 292],
            [57, 450],
            [386, 360],
            [370, 16],
            [547, 314],
            [60, 595],
            [338, 329],
            [344, 363],
            [546, 507],
            [871, 136],
            [743, 652],
            [92, 691],
            [110, 452],
            [514, 829],
            [797, 116],
            [752, 859],
            [140, 84],
            [843, 321],
            [486, 721],
            [505, 353],
            [292, 218],
            [242, 626],
            [593, 986],
            [145, 446],
            [552, 266],
            [897, 557],
            [215, 123],
            [69, 545],
            [290, 931],
            [991, 493],
            [981, 547],
            [414, 853],
            [527, 110],
            [993, 956],
            [779, 191],
            [426, 827],
            [53, 892],
            [900, 72],
            [8, 85],
            [735, 14],
            [920, 50],
            [454, 22],
            [655, 579],
            [314, 100],
            [906, 826],
            [981, 829],
            [31, 962],
            [680, 343],
            [805, 603],
            [607, 520],
            [112, 416],
            [20, 589],
            [778, 258],
            [618, 404],
            [295, 626],
            [141, 52],
            [171, 996],
            [430, 680],
            [436, 912],
            [836, 217],
            [83, 245],
            [46, 583],
            [802, 170],
            [71, 765],
            [560, 813],
            [108, 921],
            [4, 693],
            [677, 840],
            [673, 851],
            [653, 455],
            [156, 979],
            [510, 583],
            [701, 779],
            [96, 687],
            [523, 98],
            [209, 88],
            [146, 148],
            [21, 126],
            [387, 741],
            [32, 275],
            [639, 813],
            [163, 466],
            [508, 631],
            [884, 244],
            [589, 574],
            [299, 646],
            [890, 413],
            [148, 980],
            [523, 619],
            [877, 223],
            [964, 618],
            [759, 487],
            [247, 721],
            [94, 213],
            [673, 972],
            [309, 287],
            [262, 691],
            [392, 968],
            [711, 190],
            [795, 22],
            [725, 363],
            [883, 800],
            [178, 203],
            [798, 442],
            [260, 501],
            [482, 852],
            [612, 324],
            [874, 333],
            [309, 552],
            [473, 645],
            [730, 963],
            [689, 544],
            [355, 528],
            [252, 417],
            [196, 364],
            [718, 351],
            [581, 602],
            [624, 307],
            [494, 695],
            [207, 266],
            [785, 499],
            [56, 222],
            [490, 563],
            [736, 466],
            [980, 854],
            [440, 980],
            [415, 807],
            [964, 92],
            [895, 877],
            [440, 86],
            [243, 722],
            [218, 122],
            [498, 594],
            [69, 179],
            [912, 292],
            [500, 613],
            [23, 548],
            [365, 586],
            [468, 279],
            [675, 492],
            [805, 202],
            [732, 608],
            [310, 906],
            [942, 198],
            [794, 449],
            [782, 218],
            [112, 15],
            [404, 541],
            [680, 207],
            [564, 14],
            [139, 368],
            [405, 515],
            [346, 200],
            [22, 368],
            [291, 740],
            [703, 190],
            [386, 483],
            [977, 817],
            [525, 13],
            [193, 753],
            [996, 183],
            [404, 397],
            [610, 731],
            [707, 327],
            [416, 609],
            [467, 593],
            [613, 647],
            [787, 445],
            [800, 882],
            [411, 185],
            [977, 444],
            [645, 599],
            [965, 955],
            [160, 530],
            [471, 819],
            [782, 177],
            [282, 147],
            [506, 291],
            [487, 943],
            [700, 571],
            [434, 937],
            [985, 155],
            [995, 339],
            [877, 860],
            [338, 155],
            [736, 335],
            [756, 161],
            [260, 235],
            [301, 273],
            [848, 671],
            [467, 970],
            [570, 150],
            [216, 76],
            [580, 200],
            [592, 830],
            [468, 395],
            [964, 482],
            [635, 810],
            [679, 569],
            [572, 354],
            [775, 942],
            [255, 934],
            [597, 536],
            [335, 23],
            [724, 729],
            [23, 282],
            [700, 292],
            [821, 927],
            [433, 275],
            [468, 669],
            [82, 615],
            [115, 374],
            [499, 647],
            [259, 824],
            [642, 296],
            [652, 90],
            [290, 155],
            [710, 449],
            [330, 39],
            [476, 511],
            [538, 77],
            [562, 196],
            [745, 955],
            [237, 247],
            [922, 350],
            [905, 288],
            [428, 214],
            [579, 514],
            [623, 938],
            [704, 545],
            [733, 819],
            [884, 979],
            [286, 130],
            [155, 223],
            [134, 527],
            [358, 155],
            [170, 849],
            [507, 345],
            [363, 508],
            [322, 318],
            [500, 742],
            [250, 320],
            [737, 160],
            [764, 779],
            [87, 680],
            [279, 374],
            [518, 656],
            [407, 770],
            [997, 245],
            [393, 872],
            [101, 596],
            [151, 426],
            [421, 952],
            [549, 881],
            [772, 392],
            [670, 106],
            [25, 76],
            [700, 772],
            [108, 748],
            [736, 298],
            [945, 72],
            [782, 423],
            [306, 741],
            [540, 679],
            [162, 486],
            [974, 611],
            [59, 757],
            [287, 337],
            [500, 54],
            [633, 89],
            [713, 436],
            [959, 995],
            [671, 857],
            [328, 118],
            [606, 746],
            [121, 570],
            [572, 753],
            [92, 363],
            [775, 923],
            [701, 745],
            [781, 198],
            [523, 302],
            [3, 434],
            [991, 565],
            [982, 206],
            [474, 28],
            [516, 43],
            [357, 773],
            [842, 860],
            [336, 85],
            [127, 329],
            [87, 302],
            [892, 559],
            [160, 97],
            [867, 624],
            [173, 216],
            [920, 550],
            [135, 845],
            [831, 147],
            [131, 237],
            [997, 599],
            [498, 915],
            [905, 772],
            [234, 842],
            [31, 882],
            [539, 166],
            [286, 614],
            [656, 562],
            [70, 368],
            [743, 957],
            [322, 326],
            [514, 249],
            [324, 79],
            [661, 2],
            [825, 281],
            [736, 670],
            [415, 782],
            [25, 48],
            [377, 261],
            [238, 341],
            [485, 298],
            [424, 858],
            [914, 722],
            [916, 902],
            [636, 768],
            [52, 568],
            [663, 969],
            [900, 805],
            [602, 483],
            [495, 509],
            [13, 744]
        ]
    #for x in range(0,len(graph)):
    #    graph[x][0]=graph[x][0]-1
    #    graph[x][1]=graph[x][1]-1

    returnvalue=acyclicity.acyclic(graph)
    assert returnvalue==0

    G=nx.DiGraph()
    G.add_edges_from(graph)
    acyclic=nx.is_directed_acyclic_graph(G)

    assert acyclic==True

def test9_acyclicity():
    graph=[[0, 1], [1, 2], [2, 3],
           [4, 5], [5, 6], [6, 7],[7,4]]
    returnvalue=acyclicity.acyclic(graph)

    G=nx.DiGraph()
    G.add_edges_from(graph)
    acyclic=nx.is_directed_acyclic_graph(G)

    if acyclic==True:
        assert returnvalue==0
    else:
        assert returnvalue==1
    
def test10_acyclicity():
    graph=[[1, 3], [3, 0], [1, 3], [0, 2]]
    returnvalue=acyclicity.acyclic(graph)

    G=nx.DiGraph()
    G.add_edges_from(graph)
    acyclic=nx.is_directed_acyclic_graph(G)

    if acyclic==True:
        assert returnvalue==0
    else:
        assert returnvalue==1

def test11_acyclicity():
    graph=[[7, 6], [2, 4], [0, 2], [4, 3], [1, 3], [6, 4], [0, 7]]

    returnvalue=acyclicity.acyclic(graph)

    G=nx.DiGraph()
    G.add_edges_from(graph)
    acyclic=nx.is_directed_acyclic_graph(G)

    if acyclic==True:
        assert returnvalue==0
    else:
        assert returnvalue==1

def test12_acyclicity():
    graph=[[3, 6], [4, 4], [1, 2], [7, 7], [3, 3], [8, 7], [6, 7], [1, 1]]

    returnvalue=0
    returnvalue=acyclicity.acyclic(graph)

    G=nx.DiGraph()
    G.add_edges_from(graph)
    acyclic=0
    acyclic=nx.is_directed_acyclic_graph(G)

    if acyclic==True:
        assert returnvalue==0
    else:
        assert returnvalue==1

def testrandom_acyclicity(test=1000, maxnum_vertices=1000, maxnum_edges=1000):

    for i in range(0,test):
        
        num_vertices=random.randint(1,maxnum_vertices)
        num_edges=random.randint(1,maxnum_edges)
        graph=[]
        for j in range(0,num_edges):
            graph.append([random.randint(0,num_vertices-1),random.randint(0,num_vertices-1)])

        returnvalue=0
        try:
            returnvalue=acyclicity.acyclic(graph)
        except Exception as e:
            print(e)
            print(graph)
            assert False
        G=nx.DiGraph()
        G.add_edges_from(graph)
        acyclic=nx.is_directed_acyclic_graph(G)
        if acyclic==True:
            if returnvalue!=0:
                print(graph)
            assert returnvalue==0
        else:
            if returnvalue!=1:
                print(graph)
            assert returnvalue==1

        print ("testrandom_acyclicity %d/%d acyclic=%r"%(i,test,acyclic))

def test_acyclicity(graph=[]):
    returnvalue=0
    returnvalue=acyclicity.acyclic(graph)

    G=nx.DiGraph()
    G.add_edges_from(graph)
    acyclic=0
    acyclic=nx.is_directed_acyclic_graph(G)

    if acyclic==True:
        assert returnvalue==0
    else:
        assert returnvalue==1

def test13_acyclicity():
    graph=[[0, 2], [0, 1], [1, 2], [3, 0], [0, 0], [1, 0], [1, 3]]

    test_acyclicity(graph)

def test14_acyclicity():
    graph=[[3, 5], [1, 4], [4, 2], [5, 0], [4, 3], [5, 0], [4, 2], [3, 4]]
    test_acyclicity(graph)

def test15_acyclicity():
    graph=[[707, 410],
            [205, 109],
            [32, 110],
            [877, 678],
            [491, 624],
            [982, 740],
            [180, 619],
            [712, 452],
            [861, 315],
            [136, 414],
            [881, 428],
            [333, 968],
            [499, 991],
            [913, 362],
            [446, 756],
            [123, 740],
            [224, 643],
            [978, 589],
            [445, 373],
            [749, 110],
            [246, 164],
            [387, 688],
            [238, 974],
            [136, 688],
            [498, 119],
            [204, 414],
            [298, 857],
            [194, 629],
            [680, 532],
            [735, 486],
            [711, 757],
            [160, 734],
            [263, 994],
            [625, 425],
            [564, 833],
            [772, 862],
            [254, 42],
            [856, 614],
            [440, 141],
            [525, 365],
            [420, 83],
            [884, 703],
            [341, 266],
            [903, 60],
            [257, 681],
            [450, 865],
            [134, 80],
            [137, 881],
            [81, 464],
            [897, 340],
            [190, 627],
            [208, 950],
            [257, 308],
            [300, 377],
            [875, 92],
            [349, 153],
            [558, 16],
            [64, 676],
            [277, 393],
            [979, 576],
            [520, 627],
            [484, 881],
            [78, 431],
            [553, 297],
            [673, 213],
            [968, 18],
            [630, 944],
            [969, 648],
            [918, 8],
            [679, 162],
            [873, 769],
            [880, 301],
            [213, 750],
            [262, 386],
            [341, 917],
            [250, 3],
            [769, 986],
            [49, 251],
            [432, 43],
            [176, 868],
            [285, 509],
            [479, 649],
            [485, 153],
            [523, 408],
            [530, 304],
            [420, 810],
            [820, 115],
            [267, 348],
            [726, 108],
            [727, 598],
            [77, 327],
            [25, 653],
            [834, 68],
            [770, 550],
            [357, 906],
            [591, 566],
            [136, 678],
            [14, 414],
            [886, 999],
            [797, 671],
            [841, 430],
            [964, 281],
            [722, 995],
            [339, 848],
            [994, 816],
            [826, 832],
            [462, 299],
            [563, 202],
            [500, 829],
            [308, 250],
            [722, 622],
            [907, 658],
            [180, 577],
            [132, 262],
            [455, 943],
            [591, 449],
            [833, 62],
            [664, 519],
            [616, 204],
            [504, 817],
            [327, 101],
            [742, 856],
            [349, 516],
            [223, 776],
            [811, 52],
            [455, 790],
            [209, 478],
            [869, 277],
            [605, 725],
            [838, 271],
            [442, 698],
            [32, 436],
            [556, 958],
            [532, 335],
            [108, 26],
            [586, 455],
            [242, 26],
            [904, 225],
            [630, 916],
            [551, 196],
            [219, 927],
            [56, 226],
            [248, 167],
            [599, 263],
            [730, 594],
            [479, 356],
            [87, 735],
            [37, 914],
            [538, 24],
            [539, 87],
            [632, 49],
            [520, 473],
            [244, 965],
            [590, 52],
            [773, 848],
            [650, 997],
            [71, 903],
            [64, 122],
            [5, 939],
            [816, 373],
            [174, 12],
            [809, 859],
            [614, 284],
            [653, 364],
            [735, 830],
            [423, 814],
            [192, 820],
            [277, 104],
            [49, 335],
            [906, 968],
            [716, 560],
            [746, 421],
            [698, 381],
            [376, 92],
            [279, 150],
            [907, 774],
            [771, 523],
            [326, 747],
            [450, 288],
            [207, 530],
            [522, 66],
            [114, 729],
            [302, 35],
            [658, 564],
            [869, 793],
            [749, 184],
            [167, 997],
            [377, 74],
            [294, 970],
            [286, 966],
            [661, 754],
            [717, 88],
            [669, 340],
            [940, 26],
            [571, 43],
            [717, 115],
            [458, 669],
            [394, 10],
            [791, 958],
            [238, 684],
            [440, 889],
            [930, 88],
            [115, 940],
            [862, 609],
            [807, 673],
            [444, 114],
            [902, 273],
            [169, 651],
            [749, 997],
            [324, 961],
            [821, 684],
            [465, 820],
            [253, 510],
            [14, 237],
            [230, 127],
            [320, 191],
            [289, 185],
            [688, 596],
            [356, 751],
            [245, 8],
            [582, 676],
            [64, 85],
            [749, 197],
            [783, 437],
            [756, 93],
            [327, 962],
            [673, 49],
            [585, 211],
            [790, 881],
            [149, 803],
            [300, 69],
            [777, 152],
            [742, 423],
            [423, 139],
            [697, 955],
            [625, 521],
            [125, 720],
            [46, 603],
            [491, 279],
            [268, 539],
            [913, 188],
            [986, 20],
            [130, 682],
            [681, 58],
            [61, 591],
            [274, 308],
            [211, 270],
            [941, 762],
            [304, 736],
            [83, 359],
            [390, 995],
            [661, 317],
            [589, 585],
            [419, 155],
            [465, 271],
            [217, 295],
            [894, 543],
            [895, 758],
            [514, 658],
            [26, 736],
            [42, 461],
            [955, 153],
            [946, 571],
            [199, 673],
            [656, 351],
            [573, 69],
            [375, 490],
            [642, 187],
            [562, 972],
            [379, 878],
            [995, 454],
            [267, 646],
            [713, 247],
            [380, 196],
            [771, 328],
            [688, 321],
            [104, 548],
            [20, 954],
            [715, 674],
            [847, 165],
            [858, 76],
            [994, 373],
            [34, 709],
            [231, 472],
            [577, 304],
            [914, 502],
            [995, 72],
            [954, 309],
            [830, 917],
            [169, 933],
            [387, 994],
            [85, 534],
            [415, 409],
            [105, 369],
            [729, 47],
            [470, 601],
            [594, 2],
            [665, 282],
            [549, 516],
            [167, 838],
            [701, 223],
            [779, 551],
            [355, 907],
            [599, 602],
            [611, 994],
            [568, 871],            
            [346, 80],
            [872, 257],
            [178, 514],
            [530, 664],
            [295, 770],
            [79, 877],
            [359, 782],
            [18, 641],
            [287, 259],
            [613, 698],
            [425, 638],
            [893, 981],
            [988, 68],
            [594, 666],
            [274, 585],
            [885, 748],
            [644, 267],
            [833, 292],
            [134, 947],
            [870, 341],
            [732, 398],
            [989, 805],
            [485, 387],
            [203, 799],
            [673, 986],
            [281, 471],
            [130, 824],
            [573, 481],
            [834, 284],
            [688, 706],
            [706, 364],
            [266, 101],
            [937, 367],
            [772, 547],
            [157, 670],
            [981, 977],
            [590, 817],
            [309, 804],
            [854, 616],
            [693, 519],
            [454, 673],
            [663, 11],
            [386, 529],
            [83, 995],
            [509, 618],
            [138, 931],
            [145, 988],
            [678, 548],
            [160, 46],
            [421, 981],
            [952, 370],
            [386, 358],
            [471, 344],
            [87, 71],
            [612, 859],
            [33, 765],
            [694, 910],
            [161, 676],
            [324, 392],
            [604, 873],
            [443, 120],
            [571, 278],
            [92, 33],
            [47, 281],
            [268, 240],
            [268, 11],
            [417, 894],
            [35, 572],
            [124, 659],
            [495, 395],
            [608, 34],
            [74, 420],
            [53, 208],
            [596, 316],
            [894, 824],
            [176, 297],
            [263, 930],
            [292, 737],
            [830, 412],
            [712, 765],
            [252, 673],
            [420, 248],
            [124, 762],
            [158, 108],
            [665, 433],
            [383, 455],
            [483, 313],
            [213, 62],
            [494, 978],
            [469, 378],
            [287, 914],
            [824, 435],
            [661, 81],
            [567, 312],
            [431, 113],
            [455, 983],
            [166, 215],
            [826, 670],
            [854, 741],
            [732, 626],
            [195, 260],
            [612, 728],
            [158, 229],
            [949, 84],
            [838, 738],
            [852, 17],
            [80, 565],
            [343, 814],
            [663, 895],
            [991, 989],
            [232, 937],
            [201, 968],
            [250, 177],
            [16, 10],
            [536, 454],
            [288, 51],
            [588, 74],
            [307, 729],
            [892, 565],
            [365, 154],
            [155, 848],
            [978, 268],
            [286, 544],
            [820, 69],
            [707, 448],
            [113, 729],
            [292, 871],
            [803, 910],
            [957, 968],
            [795, 668],
            [165, 501],
            [751, 491],
            [807, 633],
            [535, 440],
            [888, 487],
            [856, 931],
            [562, 57],
            [588, 195],
            [320, 542],
            [919, 322],
            [976, 200],
            [124, 487],
            [965, 200],
            [724, 235],
            [149, 669],
            [188, 926],
            [892, 48],
            [804, 740],
            [555, 54],
            [679, 349],
            [707, 569],
            [367, 92],
            [785, 516],
            [437, 327],
            [348, 478],
            [480, 396],
            [493, 88],
            [632, 902],
            [770, 198],
            [699, 583],
            [566, 557],
            [414, 945],
            [588, 743],
            [260, 612],
            [514, 138],
            [493, 582],
            [107, 955],
            [589, 568],
            [850, 325],
            [840, 150],
            [514, 385],
            [839, 590],
            [148, 556],
            [828, 413],
            [480, 261],
            [868, 397],
            [321, 902],
            [5, 507],
            [429, 188],
            [710, 296],
            [546, 364],
            [368, 852],
            [921, 479],
            [390, 196],
            [967, 357],
            [871, 231],
            [374, 764],
            [912, 12],
            [358, 905],
            [439, 85],
            [333, 592],
            [398, 712],
            [401, 885],
            [72, 44],
            [476, 650],
            [833, 640],
            [282, 528],
            [393, 225],
            [135, 100],
            [78, 460],
            [314, 569],
            [390, 964],
            [955, 266],
            [128, 726],
            [325, 993],
            [863, 677],
            [527, 453],
            [767, 551],
            [126, 536],
            [198, 641],
            [183, 262],
            [31, 375],
            [128, 564],
            [580, 325],
            [925, 490],
            [49, 280],
            [666, 10],
            [871, 379],
            [901, 807],
            [240, 814],
            [761, 656],
            [254, 493],
            [126, 383],
            [102, 691],
            [310, 729],
            [693, 885],
            [51, 627],
            [872, 371],
            [991, 700],
            [61, 281],
            [456, 932],
            [958, 950],
            [709, 66],
            [8, 931],
            [490, 278],
            [996, 397],
            [547, 669],
            [266, 570],
            [183, 374],
            [630, 685],
            [763, 967],
            [145, 527],
            [338, 940],
            [498, 138],
            [265, 452],
            [276, 211],
            [822, 217],
            [599, 50],
            [966, 252],
            [764, 145],
            [931, 798],
            [790, 822],
            [867, 795],
            [553, 330],
            [938, 837],
            [992, 399],
            [160, 753],
            [751, 858],
            [634, 44],
            [575, 623],
            [107, 756],
            [329, 302],
            [356, 557],
            [506, 96],
            [480, 898],
            [744, 562],
            [68, 944],
            [468, 88],
            [944, 206],
            [287, 314],
            [959, 496],
            [554, 11],
            [691, 672],
            [141, 287],
            [940, 83],
            [809, 417],
            [69, 518],
            [758, 1000],
            [571, 774],
            [908, 32],
            [479, 511],
            [7, 799],
            [191, 480],
            [957, 162],
            [413, 602],
            [873, 703],
            [240, 274],
            [435, 193],
            [4, 501],
            [961, 645],
            [906, 620],
            [564, 362],
            [984, 530],
            [804, 572],
            [398, 549],
            [169, 726],
            [825, 375],
            [652, 75],
            [450, 596],
            [352, 451]
        ]
    test_acyclicity(graph)

if __name__ == '__main__':    
    test1_acyclicity()
    test2_acyclicity()
    test3_acyclicity()
    test4_acyclicity()
    test5_acyclicity()
    test6_acyclicity()
    test7_acyclicity()
    test8_acyclicity()
    test9_acyclicity()
    test10_acyclicity()
    test11_acyclicity()
    test12_acyclicity()
    test13_acyclicity()
    test14_acyclicity()
    test15_acyclicity()

    testrandom_acyclicity(test=10000,maxnum_vertices=10,maxnum_edges=10)
    testrandom_acyclicity(test=10000,maxnum_vertices=1000,maxnum_edges=1000)
    #testrandom_acyclicity(test=1000,maxnum_vertices=5000,maxnum_edges=5000)



#to visualize
#https://graphonline.ru/en/